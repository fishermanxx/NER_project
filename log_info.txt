2020-03-25 21:48:08,461 INFO train.py: ===== Start program
2020-03-25 21:48:08,461 INFO train.py: ===== Initialize args
2020-03-25 21:48:08,464 INFO train.py: ===== task mode: train
remove repeat sentence 0
remove repeat sentence 0
2020-03-25 21:48:09,131 INFO train.py: ===== Load metadata
2020-03-25 21:48:09,131 INFO train.py: ===== use_cuda: 1
2020-03-25 21:48:09,131 INFO train.py: Time budget: 10000
start to proprocessing data...
PreProcess 0.000 
PreProcess 0.057 
PreProcess 0.114 
PreProcess 0.171 
PreProcess 0.228 
PreProcess 0.285 
PreProcess 0.342 
PreProcess 0.399 
PreProcess 0.455 
PreProcess 0.512 
PreProcess 0.569 
PreProcess 0.626 
PreProcess 0.683 
PreProcess 0.740 
PreProcess 0.797 
PreProcess 0.854 
PreProcess 0.911 
PreProcess 0.968 
character location dict done...
ent seq map dict done...
preprocessing finished, save successfully~
max sentence length:  200
================================================================================
----model_type: BERT_Hierarchical
----use_cuda: 1
----embedding_dim: 768
----n_rel_types: 2
================================================================================
remove repeat sentence 0
2020-03-25 21:48:26,550 INFO train.py: ===== Start Train
2020-03-25 21:48:26,551 INFO train.py: There is no such file in /mnt/disk0/home/xuxin/mywork/rel_code/../result/model_test.p, Rebuild model
use cuda=========================
Process 0.063 
Process 0.126 
Process 0.190 
Process 0.253 
Process 0.316 
Process 0.379 
Process 0.443 
Process 0.506 
Process 0.569 
Process 0.632 
Process 0.696 
Process 0.759 
Process 0.822 
Process 0.885 
Process 0.949 
tensor([1.0000, 5.5500])
****BERT_finetune, learning_rate_upper: 0.001, learning_rate_bert: 5e-05
model_test.p Training start!
EPOCH: 1/20
back_up successfully
before train bias Parameter containing:
tensor([ 0.0053, -0.0308], device='cuda:0', requires_grad=True)
before ema bias tensor([ 0.0053, -0.0308], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.5348
----[TRAIN] step: 640/4741 | loss: 0.2417
----[TRAIN] step: 960/4741 | loss: 0.1983
----[TRAIN] step: 1280/4741 | loss: 0.1682
----[TRAIN] step: 1600/4741 | loss: 0.1395
----[TRAIN] step: 1920/4741 | loss: 0.1189
----[TRAIN] step: 2240/4741 | loss: 0.1103
----[TRAIN] step: 2560/4741 | loss: 0.1155
----[TRAIN] step: 2880/4741 | loss: 0.0958
----[TRAIN] step: 3200/4741 | loss: 0.0949
----[TRAIN] step: 3520/4741 | loss: 0.0830
----[TRAIN] step: 3840/4741 | loss: 0.0876
----[TRAIN] step: 4160/4741 | loss: 0.0789
----[TRAIN] step: 4480/4741 | loss: 0.0846
use cuda=========================
use cuda=========================
Process 0.567 
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.416 | recall: 0.833 | f1 score: 0.555
====================================================================================================
Checkpoint saved successfully, current best score is 0.555
EPOCH: 2/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0037, -0.0434], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0024, -0.0414], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0609
----[TRAIN] step: 640/4741 | loss: 0.0559
----[TRAIN] step: 960/4741 | loss: 0.0528
----[TRAIN] step: 1280/4741 | loss: 0.0626
----[TRAIN] step: 1600/4741 | loss: 0.0493
----[TRAIN] step: 1920/4741 | loss: 0.0567
----[TRAIN] step: 2240/4741 | loss: 0.0499
----[TRAIN] step: 2560/4741 | loss: 0.0499
----[TRAIN] step: 2880/4741 | loss: 0.0637
----[TRAIN] step: 3200/4741 | loss: 0.0600
----[TRAIN] step: 3520/4741 | loss: 0.0600
----[TRAIN] step: 3840/4741 | loss: 0.0575
----[TRAIN] step: 4160/4741 | loss: 0.0536
----[TRAIN] step: 4480/4741 | loss: 0.0533
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.492 | recall: 0.871 | f1 score: 0.629
====================================================================================================
Checkpoint saved successfully, current best score is 0.629
EPOCH: 3/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0061, -0.0452], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0054, -0.0452], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0307
----[TRAIN] step: 640/4741 | loss: 0.0364
----[TRAIN] step: 960/4741 | loss: 0.0384
----[TRAIN] step: 1280/4741 | loss: 0.0363
----[TRAIN] step: 1600/4741 | loss: 0.0338
----[TRAIN] step: 1920/4741 | loss: 0.0424
----[TRAIN] step: 2240/4741 | loss: 0.0358
----[TRAIN] step: 2560/4741 | loss: 0.0309
----[TRAIN] step: 2880/4741 | loss: 0.0371
----[TRAIN] step: 3200/4741 | loss: 0.0351
----[TRAIN] step: 3520/4741 | loss: 0.0403
----[TRAIN] step: 3840/4741 | loss: 0.0352
----[TRAIN] step: 4160/4741 | loss: 0.0317
----[TRAIN] step: 4480/4741 | loss: 0.0440
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.548 | recall: 0.865 | f1 score: 0.671
====================================================================================================
Checkpoint saved successfully, current best score is 0.671
EPOCH: 4/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0094, -0.0486], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0090, -0.0478], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0266
----[TRAIN] step: 640/4741 | loss: 0.0293
----[TRAIN] step: 960/4741 | loss: 0.0246
----[TRAIN] step: 1280/4741 | loss: 0.0279
----[TRAIN] step: 1600/4741 | loss: 0.0220
----[TRAIN] step: 1920/4741 | loss: 0.0269
----[TRAIN] step: 2240/4741 | loss: 0.0335
----[TRAIN] step: 2560/4741 | loss: 0.0335
----[TRAIN] step: 2880/4741 | loss: 0.0276
----[TRAIN] step: 3200/4741 | loss: 0.0279
----[TRAIN] step: 3520/4741 | loss: 0.0258
----[TRAIN] step: 3840/4741 | loss: 0.0219
----[TRAIN] step: 4160/4741 | loss: 0.0243
----[TRAIN] step: 4480/4741 | loss: 0.0355
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.572 | recall: 0.854 | f1 score: 0.685
====================================================================================================
Checkpoint saved successfully, current best score is 0.685
EPOCH: 5/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0103, -0.0500], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0102, -0.0499], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0182
----[TRAIN] step: 640/4741 | loss: 0.0203
----[TRAIN] step: 960/4741 | loss: 0.0193
----[TRAIN] step: 1280/4741 | loss: 0.0223
----[TRAIN] step: 1600/4741 | loss: 0.0238
----[TRAIN] step: 1920/4741 | loss: 0.0221
----[TRAIN] step: 2240/4741 | loss: 0.0342
----[TRAIN] step: 2560/4741 | loss: 0.0183
----[TRAIN] step: 2880/4741 | loss: 0.0211
----[TRAIN] step: 3200/4741 | loss: 0.0254
----[TRAIN] step: 3520/4741 | loss: 0.0199
----[TRAIN] step: 3840/4741 | loss: 0.0232
----[TRAIN] step: 4160/4741 | loss: 0.0212
----[TRAIN] step: 4480/4741 | loss: 0.0201
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.596 | recall: 0.858 | f1 score: 0.703
====================================================================================================
Checkpoint saved successfully, current best score is 0.703
EPOCH: 6/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0114, -0.0512], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0116, -0.0523], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0167
----[TRAIN] step: 640/4741 | loss: 0.0187
----[TRAIN] step: 960/4741 | loss: 0.0150
----[TRAIN] step: 1280/4741 | loss: 0.0150
----[TRAIN] step: 1600/4741 | loss: 0.0159
----[TRAIN] step: 1920/4741 | loss: 0.0161
----[TRAIN] step: 2240/4741 | loss: 0.0171
----[TRAIN] step: 2560/4741 | loss: 0.0183
----[TRAIN] step: 2880/4741 | loss: 0.0164
----[TRAIN] step: 3200/4741 | loss: 0.0168
----[TRAIN] step: 3520/4741 | loss: 0.0171
----[TRAIN] step: 3840/4741 | loss: 0.0160
----[TRAIN] step: 4160/4741 | loss: 0.0184
----[TRAIN] step: 4480/4741 | loss: 0.0191
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.63 | recall: 0.868 | f1 score: 0.73
====================================================================================================
Checkpoint saved successfully, current best score is 0.73
EPOCH: 7/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0148, -0.0547], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0144, -0.0543], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0120
----[TRAIN] step: 640/4741 | loss: 0.0207
----[TRAIN] step: 960/4741 | loss: 0.0125
----[TRAIN] step: 1280/4741 | loss: 0.0172
----[TRAIN] step: 1600/4741 | loss: 0.0137
----[TRAIN] step: 1920/4741 | loss: 0.0118
----[TRAIN] step: 2240/4741 | loss: 0.0118
----[TRAIN] step: 2560/4741 | loss: 0.0135
----[TRAIN] step: 2880/4741 | loss: 0.0236
----[TRAIN] step: 3200/4741 | loss: 0.0164
----[TRAIN] step: 3520/4741 | loss: 0.0186
----[TRAIN] step: 3840/4741 | loss: 0.0186
----[TRAIN] step: 4160/4741 | loss: 0.0130
----[TRAIN] step: 4480/4741 | loss: 0.0149
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.637 | recall: 0.854 | f1 score: 0.73
====================================================================================================
EPOCH: 8/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0143, -0.0585], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0146, -0.0570], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0176
----[TRAIN] step: 640/4741 | loss: 0.0133
----[TRAIN] step: 960/4741 | loss: 0.0131
----[TRAIN] step: 1280/4741 | loss: 0.0123
----[TRAIN] step: 1600/4741 | loss: 0.0140
----[TRAIN] step: 1920/4741 | loss: 0.0141
----[TRAIN] step: 2240/4741 | loss: 0.0132
----[TRAIN] step: 2560/4741 | loss: 0.0102
----[TRAIN] step: 2880/4741 | loss: 0.0150
----[TRAIN] step: 3200/4741 | loss: 0.0117
----[TRAIN] step: 3520/4741 | loss: 0.0165
----[TRAIN] step: 3840/4741 | loss: 0.0142
----[TRAIN] step: 4160/4741 | loss: 0.0171
----[TRAIN] step: 4480/4741 | loss: 0.0186
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.652 | recall: 0.857 | f1 score: 0.741
====================================================================================================
Checkpoint saved successfully, current best score is 0.741
EPOCH: 9/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0155, -0.0609], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0158, -0.0594], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0107
----[TRAIN] step: 640/4741 | loss: 0.0101
----[TRAIN] step: 960/4741 | loss: 0.0096
----[TRAIN] step: 1280/4741 | loss: 0.0119
----[TRAIN] step: 1600/4741 | loss: 0.0129
----[TRAIN] step: 1920/4741 | loss: 0.0109
----[TRAIN] step: 2240/4741 | loss: 0.0172
----[TRAIN] step: 2560/4741 | loss: 0.0103
----[TRAIN] step: 2880/4741 | loss: 0.0161
----[TRAIN] step: 3200/4741 | loss: 0.0144
----[TRAIN] step: 3520/4741 | loss: 0.0094
----[TRAIN] step: 3840/4741 | loss: 0.0160
----[TRAIN] step: 4160/4741 | loss: 0.0150
----[TRAIN] step: 4480/4741 | loss: 0.0119
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.664 | recall: 0.841 | f1 score: 0.742
====================================================================================================
Checkpoint saved successfully, current best score is 0.742
EPOCH: 10/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0195, -0.0627], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0193, -0.0626], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/4741 | loss: 0.0099
----[TRAIN] step: 640/4741 | loss: 0.0082
----[TRAIN] step: 960/4741 | loss: 0.0106
----[TRAIN] step: 1280/4741 | loss: 0.0119
----[TRAIN] step: 1600/4741 | loss: 0.0118
----[TRAIN] step: 1920/4741 | loss: 0.0138
----[TRAIN] step: 2240/4741 | loss: 0.0132
----[TRAIN] step: 2560/4741 | loss: 0.0087
----[TRAIN] step: 2880/4741 | loss: 0.0123
----[TRAIN] step: 3200/4741 | loss: 0.0150
----[TRAIN] step: 3520/4741 | loss: 0.0115
----[TRAIN] step: 3840/4741 | loss: 0.0106
----[TRAIN] step: 4160/4741 | loss: 0.0123
----[TRAIN] step: 4480/4741 | loss: 0.0136
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.649 | recall: 0.843 | f1 score: 0.733
====================================================================================================
restore successfully
0.0005 2.5e-05
EPOCH: 11/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0195, -0.0627], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0193, -0.0626], device='cuda:0') embed2sub.bias
0.0005 2.5e-05
----[TRAIN] step: 320/4741 | loss: 0.0106
----[TRAIN] step: 640/4741 | loss: 0.0119
----[TRAIN] step: 960/4741 | loss: 0.0125
----[TRAIN] step: 1280/4741 | loss: 0.0114
----[TRAIN] step: 1600/4741 | loss: 0.0072
----[TRAIN] step: 1920/4741 | loss: 0.0107
----[TRAIN] step: 2240/4741 | loss: 0.0081
----[TRAIN] step: 2560/4741 | loss: 0.0070
----[TRAIN] step: 2880/4741 | loss: 0.0046
----[TRAIN] step: 3200/4741 | loss: 0.0063
----[TRAIN] step: 3520/4741 | loss: 0.0072
----[TRAIN] step: 3840/4741 | loss: 0.0080
----[TRAIN] step: 4160/4741 | loss: 0.0126
----[TRAIN] step: 4480/4741 | loss: 0.0068
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.671 | recall: 0.825 | f1 score: 0.74
====================================================================================================
restore successfully
0.00025 1.25e-05
EPOCH: 12/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0195, -0.0627], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0193, -0.0626], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0075
----[TRAIN] step: 640/4741 | loss: 0.0090
----[TRAIN] step: 960/4741 | loss: 0.0114
----[TRAIN] step: 1280/4741 | loss: 0.0057
----[TRAIN] step: 1600/4741 | loss: 0.0081
----[TRAIN] step: 1920/4741 | loss: 0.0057
----[TRAIN] step: 2240/4741 | loss: 0.0090
----[TRAIN] step: 2560/4741 | loss: 0.0060
----[TRAIN] step: 2880/4741 | loss: 0.0073
----[TRAIN] step: 3200/4741 | loss: 0.0060
----[TRAIN] step: 3520/4741 | loss: 0.0104
----[TRAIN] step: 3840/4741 | loss: 0.0097
----[TRAIN] step: 4160/4741 | loss: 0.0075
----[TRAIN] step: 4480/4741 | loss: 0.0070
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.676 | recall: 0.832 | f1 score: 0.746
====================================================================================================
Checkpoint saved successfully, current best score is 0.746
EPOCH: 13/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0203, -0.0632], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0203, -0.0635], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0063
----[TRAIN] step: 640/4741 | loss: 0.0063
----[TRAIN] step: 960/4741 | loss: 0.0062
----[TRAIN] step: 1280/4741 | loss: 0.0046
----[TRAIN] step: 1600/4741 | loss: 0.0066
----[TRAIN] step: 1920/4741 | loss: 0.0039
----[TRAIN] step: 2240/4741 | loss: 0.0061
----[TRAIN] step: 2560/4741 | loss: 0.0050
----[TRAIN] step: 2880/4741 | loss: 0.0048
----[TRAIN] step: 3200/4741 | loss: 0.0074
----[TRAIN] step: 3520/4741 | loss: 0.0050
----[TRAIN] step: 3840/4741 | loss: 0.0040
----[TRAIN] step: 4160/4741 | loss: 0.0045
----[TRAIN] step: 4480/4741 | loss: 0.0040
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.691 | recall: 0.835 | f1 score: 0.756
====================================================================================================
Checkpoint saved successfully, current best score is 0.756
EPOCH: 14/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0211, -0.0649], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0210, -0.0646], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0038
----[TRAIN] step: 640/4741 | loss: 0.0042
----[TRAIN] step: 960/4741 | loss: 0.0048
----[TRAIN] step: 1280/4741 | loss: 0.0051
----[TRAIN] step: 1600/4741 | loss: 0.0047
----[TRAIN] step: 1920/4741 | loss: 0.0049
----[TRAIN] step: 2240/4741 | loss: 0.0033
----[TRAIN] step: 2560/4741 | loss: 0.0047
----[TRAIN] step: 2880/4741 | loss: 0.0051
----[TRAIN] step: 3200/4741 | loss: 0.0037
----[TRAIN] step: 3520/4741 | loss: 0.0033
----[TRAIN] step: 3840/4741 | loss: 0.0034
----[TRAIN] step: 4160/4741 | loss: 0.0024
----[TRAIN] step: 4480/4741 | loss: 0.0037
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.709 | recall: 0.825 | f1 score: 0.763
====================================================================================================
Checkpoint saved successfully, current best score is 0.763
EPOCH: 15/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0228, -0.0667], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0223, -0.0660], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0056
----[TRAIN] step: 640/4741 | loss: 0.0038
----[TRAIN] step: 960/4741 | loss: 0.0025
----[TRAIN] step: 1280/4741 | loss: 0.0053
----[TRAIN] step: 1600/4741 | loss: 0.0045
----[TRAIN] step: 1920/4741 | loss: 0.0026
----[TRAIN] step: 2240/4741 | loss: 0.0028
----[TRAIN] step: 2560/4741 | loss: 0.0037
----[TRAIN] step: 2880/4741 | loss: 0.0052
----[TRAIN] step: 3200/4741 | loss: 0.0026
----[TRAIN] step: 3520/4741 | loss: 0.0024
----[TRAIN] step: 3840/4741 | loss: 0.0036
----[TRAIN] step: 4160/4741 | loss: 0.0039
----[TRAIN] step: 4480/4741 | loss: 0.0046
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.707 | recall: 0.835 | f1 score: 0.766
====================================================================================================
Checkpoint saved successfully, current best score is 0.766
EPOCH: 16/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0227, -0.0662], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0227, -0.0661], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0026
----[TRAIN] step: 640/4741 | loss: 0.0034
----[TRAIN] step: 960/4741 | loss: 0.0023
----[TRAIN] step: 1280/4741 | loss: 0.0033
----[TRAIN] step: 1600/4741 | loss: 0.0028
----[TRAIN] step: 1920/4741 | loss: 0.0030
----[TRAIN] step: 2240/4741 | loss: 0.0024
----[TRAIN] step: 2560/4741 | loss: 0.0024
----[TRAIN] step: 2880/4741 | loss: 0.0028
----[TRAIN] step: 3200/4741 | loss: 0.0038
----[TRAIN] step: 3520/4741 | loss: 0.0022
----[TRAIN] step: 3840/4741 | loss: 0.0032
----[TRAIN] step: 4160/4741 | loss: 0.0030
----[TRAIN] step: 4480/4741 | loss: 0.0032
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.719 | recall: 0.821 | f1 score: 0.767
====================================================================================================
Checkpoint saved successfully, current best score is 0.767
EPOCH: 17/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0232, -0.0663], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0230, -0.0663], device='cuda:0') embed2sub.bias
0.00025 1.25e-05
----[TRAIN] step: 320/4741 | loss: 0.0038
----[TRAIN] step: 640/4741 | loss: 0.0029
----[TRAIN] step: 960/4741 | loss: 0.0026
----[TRAIN] step: 1280/4741 | loss: 0.0019
----[TRAIN] step: 1600/4741 | loss: 0.0034
----[TRAIN] step: 1920/4741 | loss: 0.0037
----[TRAIN] step: 2240/4741 | loss: 0.0023
----[TRAIN] step: 2560/4741 | loss: 0.0036
----[TRAIN] step: 2880/4741 | loss: 0.0060
----[TRAIN] step: 3200/4741 | loss: 0.0034
----[TRAIN] step: 3520/4741 | loss: 0.0028
----[TRAIN] step: 3840/4741 | loss: 0.0030
----[TRAIN] step: 4160/4741 | loss: 0.0038
----[TRAIN] step: 4480/4741 | loss: 0.0026
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.709 | recall: 0.825 | f1 score: 0.763
====================================================================================================
restore successfully
0.000125 6.25e-06
EPOCH: 18/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0232, -0.0663], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0230, -0.0663], device='cuda:0') embed2sub.bias
0.000125 6.25e-06
----[TRAIN] step: 320/4741 | loss: 0.0030
----[TRAIN] step: 640/4741 | loss: 0.0013
----[TRAIN] step: 960/4741 | loss: 0.0027
----[TRAIN] step: 1280/4741 | loss: 0.0046
----[TRAIN] step: 1600/4741 | loss: 0.0029
----[TRAIN] step: 1920/4741 | loss: 0.0027
----[TRAIN] step: 2240/4741 | loss: 0.0023
----[TRAIN] step: 2560/4741 | loss: 0.0017
----[TRAIN] step: 2880/4741 | loss: 0.0025
----[TRAIN] step: 3200/4741 | loss: 0.0035
----[TRAIN] step: 3520/4741 | loss: 0.0036
----[TRAIN] step: 3840/4741 | loss: 0.0034
----[TRAIN] step: 4160/4741 | loss: 0.0026
----[TRAIN] step: 4480/4741 | loss: 0.0021
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.721 | recall: 0.819 | f1 score: 0.767
====================================================================================================
EPOCH: 19/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0237, -0.0669], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0232, -0.0665], device='cuda:0') embed2sub.bias
0.000125 6.25e-06
----[TRAIN] step: 320/4741 | loss: 0.0023
----[TRAIN] step: 640/4741 | loss: 0.0030
----[TRAIN] step: 960/4741 | loss: 0.0025
----[TRAIN] step: 1280/4741 | loss: 0.0023
----[TRAIN] step: 1600/4741 | loss: 0.0029
----[TRAIN] step: 1920/4741 | loss: 0.0024
----[TRAIN] step: 2240/4741 | loss: 0.0035
----[TRAIN] step: 2560/4741 | loss: 0.0022
----[TRAIN] step: 2880/4741 | loss: 0.0024
----[TRAIN] step: 3200/4741 | loss: 0.0026
----[TRAIN] step: 3520/4741 | loss: 0.0028
----[TRAIN] step: 3840/4741 | loss: 0.0023
----[TRAIN] step: 4160/4741 | loss: 0.0041
----[TRAIN] step: 4480/4741 | loss: 0.0028
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.729 | recall: 0.816 | f1 score: 0.77
====================================================================================================
Checkpoint saved successfully, current best score is 0.77
EPOCH: 20/20
back_up successfully
before train bias Parameter containing:
tensor([-0.0237, -0.0661], device='cuda:0', requires_grad=True)
before ema bias tensor([-0.0240, -0.0666], device='cuda:0') embed2sub.bias
0.000125 6.25e-06
----[TRAIN] step: 320/4741 | loss: 0.0016
----[TRAIN] step: 640/4741 | loss: 0.0014
----[TRAIN] step: 960/4741 | loss: 0.0026
----[TRAIN] step: 1280/4741 | loss: 0.0032
----[TRAIN] step: 1600/4741 | loss: 0.0018
----[TRAIN] step: 1920/4741 | loss: 0.0011
----[TRAIN] step: 2240/4741 | loss: 0.0028
----[TRAIN] step: 2560/4741 | loss: 0.0029
----[TRAIN] step: 2880/4741 | loss: 0.0036
----[TRAIN] step: 3200/4741 | loss: 0.0025
----[TRAIN] step: 3520/4741 | loss: 0.0039
----[TRAIN] step: 3840/4741 | loss: 0.0038
----[TRAIN] step: 4160/4741 | loss: 0.0026
----[TRAIN] step: 4480/4741 | loss: 0.0028
use cuda=========================
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 200/527
----[PREDICT] step 400/527
Eval start
====================================================================================================
[FINAL] | precision: 0.718 | recall: 0.818 | f1 score: 0.765
====================================================================================================
restore successfully
6.25e-05 3.125e-06
early stop!!!
the best score of the model is 0.77
2020-03-25 22:28:30,635 INFO common.py: training success, time spent so far 2404.0837 sec


2020-03-25 22:28:31,142 INFO train.py: ===== Start Eval
2020-03-25 22:28:31,411 INFO train.py: Reload model successfully~
2020-03-25 22:28:31,412 INFO train.py: reload model model_test.p
use cuda=========================
use cuda=========================
Process 0.511 
Predict start!
----[PREDICT] step 200/585
----[PREDICT] step 400/585
save the predict result in /mnt/disk0/home/xuxin/mywork/rel_code/../result/predict.json
Eval start
====================================================================================================
[FINAL] | precision: 0.719 | recall: 0.841 | f1 score: 0.775
====================================================================================================
2020-03-25 22:28:53,240 INFO common.py: eval success, time spent so far 21.8279 sec


