2020-03-27 14:31:01,943 INFO train.py: ===== Start program
2020-03-27 14:31:01,943 INFO train.py: ===== Initialize args
2020-03-27 14:31:01,946 INFO train.py: ===== task mode: train
remove repeat sentence 0
remove repeat sentence 0
2020-03-27 14:31:03,007 INFO train.py: ===== Load metadata
2020-03-27 14:31:03,007 INFO train.py: ===== use_cuda: 1
2020-03-27 14:31:03,008 INFO train.py: Time budget: 15000
max sentence length:  130
================================================================================
----model_type: BERT_Hierarchical
----use_cuda: 1
----embedding_dim: 768
----n_rel_types: 10
================================================================================
remove repeat sentence 0
2020-03-27 14:31:36,628 INFO train.py: ===== Start Train
2020-03-27 14:31:36,628 INFO train.py: There is no such file in /mnt/disk0/home/xuxin/mywork/rel_code/../result/model_test.p, Rebuild model
use cuda=========================
Reload preprocessed data successfully~
tensor([1., 1.], requires_grad=True)
****BERT_finetune, learning_rate_upper: 0.001, learning_rate_bert: 5e-05
model_test.p Training start!
EPOCH: 1/20
back_up successfully
before train bias Parameter containing:
tensor([ 0.0053, -0.0308], device='cuda:0', requires_grad=True)
before ema bias tensor([ 0.0053, -0.0308], device='cuda:0') embed2sub.bias
0.001 5e-05
----[TRAIN] step: 320/9075 | loss: 0.1948
self.alpha:  tensor([1., 1.], requires_grad=True)
----[TRAIN] step: 640/9075 | loss: 0.0637
self.alpha:  tensor([1., 1.], requires_grad=True)
----[TRAIN] step: 960/9075 | loss: 0.0422
self.alpha:  tensor([1., 1.], requires_grad=True)
