2020-02-15 12:30:35,939 INFO train.py: ===== Start program
2020-02-15 12:30:35,939 INFO train.py: ===== Initialize args
2020-02-15 12:30:35,943 INFO train.py: ===== task mode: train
2020-02-15 12:30:38,090 INFO train.py: ===== Load metadata
2020-02-15 12:30:38,091 INFO train.py: ===== use_cuda: 1
2020-02-15 12:30:38,091 INFO train.py: Time budget: 15000
start to proprocessing data...
PreProcess 0.021 
PreProcess 0.042 
PreProcess 0.062 
PreProcess 0.083 
PreProcess 0.104 
PreProcess 0.125 
PreProcess 0.146 
PreProcess 0.167 
PreProcess 0.187 
PreProcess 0.208 
PreProcess 0.229 
PreProcess 0.250 
PreProcess 0.271 
PreProcess 0.292 
PreProcess 0.312 
PreProcess 0.333 
PreProcess 0.354 
PreProcess 0.375 
PreProcess 0.396 
PreProcess 0.416 
PreProcess 0.437 
PreProcess 0.458 
PreProcess 0.479 
PreProcess 0.500 
PreProcess 0.521 
PreProcess 0.541 
PreProcess 0.562 
PreProcess 0.583 
PreProcess 0.604 
PreProcess 0.625 
PreProcess 0.646 
PreProcess 0.666 
PreProcess 0.687 
PreProcess 0.708 
PreProcess 0.729 
PreProcess 0.750 
PreProcess 0.770 
PreProcess 0.791 
PreProcess 0.812 
PreProcess 0.833 
PreProcess 0.854 
PreProcess 0.875 
PreProcess 0.895 
PreProcess 0.916 
PreProcess 0.937 
PreProcess 0.958 
PreProcess 0.979 
PreProcess 1.000 
character location dict done...
pos location dict done...
ent seq map dict done...
preprocessing finished, save successfully~
================================================================================
----model_type: BERT_CRF
----embedding_dim: 768
----num_labels: 45
----use_cuda: 1
================================================================================
2020-02-15 12:32:41,158 INFO train.py: ===== Start Train
2020-02-15 12:32:41,158 INFO train.py: There is no such file in /mnt/disk0/home/xuxin/mywork/code/../result/model_test.p, Rebuild model
use cuda=========================
Process 0.000 
Process 0.030 
Process 0.060 
Process 0.089 
Process 0.119 
Process 0.149 
Process 0.179 
Process 0.208 
Process 0.238 
Process 0.268 
Process 0.298 
Process 0.327 
Process 0.357 
Process 0.387 
Process 0.417 
Process 0.446 
Process 0.476 
Process 0.506 
Process 0.536 
Process 0.565 
Process 0.595 
Process 0.625 
Process 0.655 
Process 0.684 
Process 0.714 
Process 0.744 
Process 0.774 
Process 0.803 
Process 0.833 
Process 0.863 
Process 0.893 
Process 0.922 
Process 0.952 
Process 0.982 
****BERT_finetune, learning_rate_upper: 0.005, learning_rate_bert: 5e-05
model_test.p Training start!
EPOCH: 1/15
----[TRAIN] step: 1280/10084 | loss: 2.8786
----[TRAIN] step: 2560/10084 | loss: 2.5115
----[TRAIN] step: 3840/10084 | loss: 2.2991
----[TRAIN] step: 5120/10084 | loss: 2.0519
----[TRAIN] step: 6400/10084 | loss: 1.8831
----[TRAIN] step: 7680/10084 | loss: 1.6911
----[TRAIN] step: 8960/10084 | loss: 1.5294
use cuda=========================
Process 0.000 
Process 0.069 
Process 0.139 
Process 0.208 
Process 0.278 
Process 0.347 
Process 0.416 
Process 0.486 
Process 0.555 
Process 0.625 
Process 0.694 
Process 0.763 
Process 0.833 
Process 0.902 
Process 0.972 
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.0 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 2000/4323 | precision: 0.333 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 3000/4323 | precision: 0.4 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 4000/4323 | precision: 0.364 | recall: 0.0 | f1 score: 0.0
====================================================================================================
[FINAL] | precision: 0.364 | recall: 0.0 | f1 score: 0.0
====================================================================================================
EPOCH: 2/15
----[TRAIN] step: 1280/10084 | loss: 1.2436
----[TRAIN] step: 2560/10084 | loss: 1.1059
----[TRAIN] step: 3840/10084 | loss: 0.9921
----[TRAIN] step: 5120/10084 | loss: 0.8788
----[TRAIN] step: 6400/10084 | loss: 0.7888
----[TRAIN] step: 7680/10084 | loss: 0.7020
----[TRAIN] step: 8960/10084 | loss: 0.6302
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.0 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 2000/4323 | precision: 0.5 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 3000/4323 | precision: 0.5 | recall: 0.0 | f1 score: 0.0
----[EVAL] step 4000/4323 | precision: 0.5 | recall: 0.0 | f1 score: 0.0
====================================================================================================
[FINAL] | precision: 0.5 | recall: 0.0 | f1 score: 0.0
====================================================================================================
EPOCH: 3/15
----[TRAIN] step: 1280/10084 | loss: 0.5378
----[TRAIN] step: 2560/10084 | loss: 0.5011
----[TRAIN] step: 3840/10084 | loss: 0.4742
----[TRAIN] step: 5120/10084 | loss: 0.4333
----[TRAIN] step: 6400/10084 | loss: 0.4077
----[TRAIN] step: 7680/10084 | loss: 0.3758
----[TRAIN] step: 8960/10084 | loss: 0.3510
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.315 | recall: 0.065 | f1 score: 0.108
----[EVAL] step 2000/4323 | precision: 0.316 | recall: 0.064 | f1 score: 0.106
----[EVAL] step 3000/4323 | precision: 0.318 | recall: 0.063 | f1 score: 0.105
----[EVAL] step 4000/4323 | precision: 0.314 | recall: 0.062 | f1 score: 0.104
====================================================================================================
[FINAL] | precision: 0.314 | recall: 0.062 | f1 score: 0.104
====================================================================================================
Checkpoint saved successfully, current best socre is 0.104
EPOCH: 4/15
----[TRAIN] step: 1280/10084 | loss: 0.3190
----[TRAIN] step: 2560/10084 | loss: 0.3006
----[TRAIN] step: 3840/10084 | loss: 0.2977
----[TRAIN] step: 5120/10084 | loss: 0.2738
----[TRAIN] step: 6400/10084 | loss: 0.2710
----[TRAIN] step: 7680/10084 | loss: 0.2553
----[TRAIN] step: 8960/10084 | loss: 0.2411
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.739 | recall: 0.389 | f1 score: 0.51
----[EVAL] step 2000/4323 | precision: 0.743 | recall: 0.392 | f1 score: 0.513
----[EVAL] step 3000/4323 | precision: 0.735 | recall: 0.385 | f1 score: 0.505
----[EVAL] step 4000/4323 | precision: 0.741 | recall: 0.389 | f1 score: 0.51
====================================================================================================
[FINAL] | precision: 0.74 | recall: 0.389 | f1 score: 0.51
====================================================================================================
Checkpoint saved successfully, current best socre is 0.51
EPOCH: 5/15
----[TRAIN] step: 1280/10084 | loss: 0.2354
----[TRAIN] step: 2560/10084 | loss: 0.2233
----[TRAIN] step: 3840/10084 | loss: 0.2134
----[TRAIN] step: 5120/10084 | loss: 0.1886
----[TRAIN] step: 6400/10084 | loss: 0.1875
----[TRAIN] step: 7680/10084 | loss: 0.1806
----[TRAIN] step: 8960/10084 | loss: 0.1713
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.78 | recall: 0.565 | f1 score: 0.655
----[EVAL] step 2000/4323 | precision: 0.776 | recall: 0.56 | f1 score: 0.651
----[EVAL] step 3000/4323 | precision: 0.77 | recall: 0.554 | f1 score: 0.644
----[EVAL] step 4000/4323 | precision: 0.77 | recall: 0.556 | f1 score: 0.646
====================================================================================================
[FINAL] | precision: 0.772 | recall: 0.557 | f1 score: 0.647
====================================================================================================
Checkpoint saved successfully, current best socre is 0.647
EPOCH: 6/15
----[TRAIN] step: 1280/10084 | loss: 0.1769
----[TRAIN] step: 2560/10084 | loss: 0.1684
----[TRAIN] step: 3840/10084 | loss: 0.1687
----[TRAIN] step: 5120/10084 | loss: 0.1611
----[TRAIN] step: 6400/10084 | loss: 0.1638
----[TRAIN] step: 7680/10084 | loss: 0.1636
----[TRAIN] step: 8960/10084 | loss: 0.1549
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.76 | recall: 0.555 | f1 score: 0.642
----[EVAL] step 2000/4323 | precision: 0.763 | recall: 0.552 | f1 score: 0.641
----[EVAL] step 3000/4323 | precision: 0.76 | recall: 0.548 | f1 score: 0.637
----[EVAL] step 4000/4323 | precision: 0.762 | recall: 0.55 | f1 score: 0.639
====================================================================================================
[FINAL] | precision: 0.764 | recall: 0.551 | f1 score: 0.64
====================================================================================================
EPOCH: 7/15
----[TRAIN] step: 1280/10084 | loss: 0.1545
----[TRAIN] step: 2560/10084 | loss: 0.1484
----[TRAIN] step: 3840/10084 | loss: 0.1492
----[TRAIN] step: 5120/10084 | loss: 0.1468
----[TRAIN] step: 6400/10084 | loss: 0.1371
----[TRAIN] step: 7680/10084 | loss: 0.1358
----[TRAIN] step: 8960/10084 | loss: 0.1371
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.77 | recall: 0.609 | f1 score: 0.68
----[EVAL] step 2000/4323 | precision: 0.77 | recall: 0.608 | f1 score: 0.679
----[EVAL] step 3000/4323 | precision: 0.765 | recall: 0.604 | f1 score: 0.675
----[EVAL] step 4000/4323 | precision: 0.765 | recall: 0.605 | f1 score: 0.676
====================================================================================================
[FINAL] | precision: 0.766 | recall: 0.606 | f1 score: 0.677
====================================================================================================
Checkpoint saved successfully, current best socre is 0.677
EPOCH: 8/15
----[TRAIN] step: 1280/10084 | loss: 0.1219
----[TRAIN] step: 2560/10084 | loss: 0.1216
----[TRAIN] step: 3840/10084 | loss: 0.1142
----[TRAIN] step: 5120/10084 | loss: 0.1166
----[TRAIN] step: 6400/10084 | loss: 0.1105
----[TRAIN] step: 7680/10084 | loss: 0.1015
----[TRAIN] step: 8960/10084 | loss: 0.1020
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.764 | recall: 0.599 | f1 score: 0.672
----[EVAL] step 2000/4323 | precision: 0.766 | recall: 0.598 | f1 score: 0.672
----[EVAL] step 3000/4323 | precision: 0.762 | recall: 0.594 | f1 score: 0.668
----[EVAL] step 4000/4323 | precision: 0.763 | recall: 0.597 | f1 score: 0.67
====================================================================================================
[FINAL] | precision: 0.764 | recall: 0.599 | f1 score: 0.672
====================================================================================================
EPOCH: 9/15
----[TRAIN] step: 1280/10084 | loss: 0.0957
----[TRAIN] step: 2560/10084 | loss: 0.0908
----[TRAIN] step: 3840/10084 | loss: 0.0897
----[TRAIN] step: 5120/10084 | loss: 0.0889
----[TRAIN] step: 6400/10084 | loss: 0.0862
----[TRAIN] step: 7680/10084 | loss: 0.0823
----[TRAIN] step: 8960/10084 | loss: 0.0823
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.767 | recall: 0.642 | f1 score: 0.699
----[EVAL] step 2000/4323 | precision: 0.767 | recall: 0.644 | f1 score: 0.7
----[EVAL] step 3000/4323 | precision: 0.761 | recall: 0.638 | f1 score: 0.694
----[EVAL] step 4000/4323 | precision: 0.762 | recall: 0.642 | f1 score: 0.697
====================================================================================================
[FINAL] | precision: 0.764 | recall: 0.643 | f1 score: 0.698
====================================================================================================
Checkpoint saved successfully, current best socre is 0.698
EPOCH: 10/15
----[TRAIN] step: 1280/10084 | loss: 0.0720
----[TRAIN] step: 2560/10084 | loss: 0.0743
----[TRAIN] step: 3840/10084 | loss: 0.0781
----[TRAIN] step: 5120/10084 | loss: 0.0744
----[TRAIN] step: 6400/10084 | loss: 0.0717
----[TRAIN] step: 7680/10084 | loss: 0.0713
----[TRAIN] step: 8960/10084 | loss: 0.0737
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.765 | recall: 0.643 | f1 score: 0.699
----[EVAL] step 2000/4323 | precision: 0.763 | recall: 0.644 | f1 score: 0.698
----[EVAL] step 3000/4323 | precision: 0.758 | recall: 0.638 | f1 score: 0.693
----[EVAL] step 4000/4323 | precision: 0.76 | recall: 0.643 | f1 score: 0.697
====================================================================================================
[FINAL] | precision: 0.762 | recall: 0.644 | f1 score: 0.698
====================================================================================================
EPOCH: 11/15
----[TRAIN] step: 1280/10084 | loss: 0.0667
----[TRAIN] step: 2560/10084 | loss: 0.0691
----[TRAIN] step: 3840/10084 | loss: 0.0691
----[TRAIN] step: 5120/10084 | loss: 0.0682
----[TRAIN] step: 6400/10084 | loss: 0.0661
----[TRAIN] step: 7680/10084 | loss: 0.0624
----[TRAIN] step: 8960/10084 | loss: 0.0646
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.778 | recall: 0.646 | f1 score: 0.706
----[EVAL] step 2000/4323 | precision: 0.782 | recall: 0.651 | f1 score: 0.711
----[EVAL] step 3000/4323 | precision: 0.774 | recall: 0.645 | f1 score: 0.704
----[EVAL] step 4000/4323 | precision: 0.775 | recall: 0.649 | f1 score: 0.706
====================================================================================================
[FINAL] | precision: 0.776 | recall: 0.649 | f1 score: 0.707
====================================================================================================
Checkpoint saved successfully, current best socre is 0.707
EPOCH: 12/15
----[TRAIN] step: 1280/10084 | loss: 0.0594
----[TRAIN] step: 2560/10084 | loss: 0.0599
----[TRAIN] step: 3840/10084 | loss: 0.0583
----[TRAIN] step: 5120/10084 | loss: 0.0612
----[TRAIN] step: 6400/10084 | loss: 0.0624
----[TRAIN] step: 7680/10084 | loss: 0.0609
----[TRAIN] step: 8960/10084 | loss: 0.0601
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.769 | recall: 0.66 | f1 score: 0.71
----[EVAL] step 2000/4323 | precision: 0.771 | recall: 0.664 | f1 score: 0.714
----[EVAL] step 3000/4323 | precision: 0.767 | recall: 0.662 | f1 score: 0.711
----[EVAL] step 4000/4323 | precision: 0.768 | recall: 0.664 | f1 score: 0.712
====================================================================================================
[FINAL] | precision: 0.771 | recall: 0.665 | f1 score: 0.714
====================================================================================================
Checkpoint saved successfully, current best socre is 0.714
EPOCH: 13/15
----[TRAIN] step: 1280/10084 | loss: 0.0551
----[TRAIN] step: 2560/10084 | loss: 0.0571
----[TRAIN] step: 3840/10084 | loss: 0.0563
----[TRAIN] step: 5120/10084 | loss: 0.0566
----[TRAIN] step: 6400/10084 | loss: 0.0555
----[TRAIN] step: 7680/10084 | loss: 0.0557
----[TRAIN] step: 8960/10084 | loss: 0.0544
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.781 | recall: 0.656 | f1 score: 0.713
----[EVAL] step 2000/4323 | precision: 0.774 | recall: 0.654 | f1 score: 0.709
----[EVAL] step 3000/4323 | precision: 0.77 | recall: 0.65 | f1 score: 0.705
----[EVAL] step 4000/4323 | precision: 0.772 | recall: 0.653 | f1 score: 0.708
====================================================================================================
[FINAL] | precision: 0.773 | recall: 0.654 | f1 score: 0.709
====================================================================================================
EPOCH: 14/15
----[TRAIN] step: 1280/10084 | loss: 0.0550
----[TRAIN] step: 2560/10084 | loss: 0.0529
----[TRAIN] step: 3840/10084 | loss: 0.0529
----[TRAIN] step: 5120/10084 | loss: 0.0507
----[TRAIN] step: 6400/10084 | loss: 0.0502
----[TRAIN] step: 7680/10084 | loss: 0.0537
----[TRAIN] step: 8960/10084 | loss: 0.0481
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.778 | recall: 0.67 | f1 score: 0.72
----[EVAL] step 2000/4323 | precision: 0.777 | recall: 0.672 | f1 score: 0.721
----[EVAL] step 3000/4323 | precision: 0.77 | recall: 0.669 | f1 score: 0.716
----[EVAL] step 4000/4323 | precision: 0.77 | recall: 0.671 | f1 score: 0.717
====================================================================================================
[FINAL] | precision: 0.771 | recall: 0.672 | f1 score: 0.718
====================================================================================================
Checkpoint saved successfully, current best socre is 0.718
EPOCH: 15/15
----[TRAIN] step: 1280/10084 | loss: 0.0453
----[TRAIN] step: 2560/10084 | loss: 0.0478
----[TRAIN] step: 3840/10084 | loss: 0.0462
----[TRAIN] step: 5120/10084 | loss: 0.0468
----[TRAIN] step: 6400/10084 | loss: 0.0470
----[TRAIN] step: 7680/10084 | loss: 0.0505
----[TRAIN] step: 8960/10084 | loss: 0.0460
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
Eval start
----[EVAL] step 1000/4323 | precision: 0.763 | recall: 0.663 | f1 score: 0.709
----[EVAL] step 2000/4323 | precision: 0.76 | recall: 0.664 | f1 score: 0.709
----[EVAL] step 3000/4323 | precision: 0.756 | recall: 0.66 | f1 score: 0.705
----[EVAL] step 4000/4323 | precision: 0.757 | recall: 0.663 | f1 score: 0.707
====================================================================================================
[FINAL] | precision: 0.758 | recall: 0.663 | f1 score: 0.707
====================================================================================================
the best score of the model is 0.718
2020-02-15 13:04:36,290 INFO common.py: training success, time spent so far 1915.1307 sec


2020-02-15 13:04:36,778 INFO train.py: ===== Start Eval
2020-02-15 13:04:37,172 INFO train.py: Reload model successfully~
2020-02-15 13:04:37,172 INFO train.py: reload model model_test.p
use cuda=========================
Reload preprocessed data successfully~
Predict start!
----[PREDICT] step 1000/4323
----[PREDICT] step 2000/4323
----[PREDICT] step 3000/4323
----[PREDICT] step 4000/4323
save the predict result in /mnt/disk0/home/xuxin/mywork/code/../result/predict.json
Eval start
----[EVAL] step 1000/4323 | precision: 0.778 | recall: 0.67 | f1 score: 0.72
----[EVAL] step 2000/4323 | precision: 0.777 | recall: 0.672 | f1 score: 0.721
----[EVAL] step 3000/4323 | precision: 0.77 | recall: 0.669 | f1 score: 0.716
----[EVAL] step 4000/4323 | precision: 0.77 | recall: 0.671 | f1 score: 0.717
====================================================================================================
[FINAL] | precision: 0.771 | recall: 0.672 | f1 score: 0.718
====================================================================================================
2020-02-15 13:04:57,551 INFO common.py: eval success, time spent so far 20.3785 sec


